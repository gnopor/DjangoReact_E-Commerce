{"ast":null,"code":"var _jsxFileName = \"/home/gnop/Videos/django-react-boilerplate/src/containers/Checkout.js\";\nimport React, { Component } from 'react';\nimport { CardElement, injectStripe, Elements, StripeProvider } from 'react-stripe-elements';\nimport { Button, Container, Dimmer, Divider, Form, Item, Header, Message, Loader, Label, Segment } from 'semantic-ui-react';\nimport { authAxios } from '../utils';\nimport { checkoutURL, orderSummaryURL, addCouponURL } from '../constants';\n\nclass OrderPreview extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: null,\n      error: null,\n      loading: false\n    };\n\n    this.handleFetchOrder = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(orderSummaryURL).then(res => {\n        //console.log(res.data);\n        this.setState({\n          data: res.data,\n          loading: false\n        });\n      }).catch(err => {\n        if (err.reponse.status === 404) {\n          this.setState({\n            error: \"You currently do not have an order\",\n            loading: false\n          });\n        } else {\n          this.setState({\n            error: err,\n            loading: false\n          });\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.handleFetchOrder();\n  }\n\n  render() {\n    const {\n      data,\n      error,\n      loading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 13\n      }\n    }, error && /*#__PURE__*/React.createElement(Message, {\n      error: true,\n      header: \"There was an error\",\n      content: JSON.stringify(error),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 21\n      }\n    }), loading && /*#__PURE__*/React.createElement(Segment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Dimmer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Loader, {\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 29\n      }\n    }, \"Loading\"))), data && /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Item.Group, {\n      relaxed: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 25\n      }\n    }, data.order_items.map((order_item, i) => {\n      console.log(order_item);\n      return /*#__PURE__*/React.createElement(Item, {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(Item.Image, {\n        size: \"tiny\",\n        src: `http://127.0.0.1:8000${order_item.item_obj.image}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 41\n        }\n      }), /*#__PURE__*/React.createElement(Item.Content, {\n        verticalAlign: \"middle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 41\n        }\n      }, /*#__PURE__*/React.createElement(Item.Header, {\n        as: \"a\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 45\n        }\n      }, order_item.quantity, \" x \", order_item.item_obj.title), /*#__PURE__*/React.createElement(Item.Extra, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(Label, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 49\n        }\n      }, \"$\", order_item.final_price))));\n    })), /*#__PURE__*/React.createElement(Item.Group, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Item.Content, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Item.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 33\n      }\n    }, \"Order Total: $\", data.total, \" \")))));\n  }\n\n}\n\nclass CouponForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      error: null,\n      loading: false\n    };\n\n    this.handleAddCoupon = e => {\n      e.preventDefault();\n      const {\n        code\n      } = this.state;\n      this.setState({\n        loading: true\n      });\n      authAxios.post(addCouponURL, {\n        code\n      }).then(res => {\n        this.setState({\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleChange = e => {\n      this.setState({\n        code: e.target.value\n      });\n    };\n  }\n\n  render() {\n    const {\n      code,\n      error,\n      loading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 13\n      }\n    }, error && /*#__PURE__*/React.createElement(Message, {\n      error: true,\n      header: \"There was an error\",\n      content: JSON.stringify(error),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    }), loading && /*#__PURE__*/React.createElement(Segment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Dimmer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Loader, {\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 29\n      }\n    }, \"Loading\"))), /*#__PURE__*/React.createElement(Form, {\n      onSubmit: this.handleAddCoupon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 25\n      }\n    }, \"Coupon code\"), /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"Enter a coupon...\",\n      value: code,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 25\n      }\n    }))));\n  }\n\n}\n\nclass CheckoutForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: false,\n      error: null,\n      success: false\n    };\n\n    this.submit = ev => {\n      ev.preventDefault();\n      this.setState({\n        loading: true\n      });\n\n      if (this.props.stripe) {\n        this.props.stripe.createToken().then(result => {\n          if (result.error) {\n            this.setState({\n              error: result.error.message,\n              loading: false\n            });\n          } else {\n            authAxios.post(checkoutURL, {\n              stripeToken: result.token.id\n            }).then(res => {\n              this.setState({\n                loading: true,\n                success: true\n              });\n            }).catch(err => {\n              this.setState({\n                loading: false,\n                error: err\n              });\n            });\n          }\n        });\n      } else {\n        console.log(\"Stripe is not loaded\");\n      }\n    };\n  }\n\n  render() {\n    const {\n      error,\n      loading,\n      success\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 13\n      }\n    }, error && /*#__PURE__*/React.createElement(Message, {\n      negative: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Message.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 25\n      }\n    }, \"Your payment was unsuccessful\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 25\n      }\n    }, JSON.stringify(error))), success && /*#__PURE__*/React.createElement(Message, {\n      positive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Message.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 25\n      }\n    }, \"Your payment was successful\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 25\n      }\n    }, \"Go to your \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 40\n      }\n    }, \"profile\"), \" to see the order delivery status.\")), /*#__PURE__*/React.createElement(OrderPreview, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(CouponForm, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 17\n      }\n    }, \"Would you like to complete your puchase?\"), /*#__PURE__*/React.createElement(CardElement, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      onClick: this.submit,\n      primary: true,\n      style: {\n        marginTop: \"10px\"\n      },\n      loading: loading,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }\n    }, \"Submit\"));\n  }\n\n}\n\nconst InjectedForm = injectStripe(CheckoutForm);\n\nconst WrappedForm = () => /*#__PURE__*/React.createElement(Container, {\n  text: true,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 261,\n    columnNumber: 5\n  }\n}, /*#__PURE__*/React.createElement(StripeProvider, {\n  apiKey: \"pk_test_ffJsfC2lo7brg48q4ijmDjK000UJ9rB62K\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 262,\n    columnNumber: 9\n  }\n}, /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 13\n  }\n}, /*#__PURE__*/React.createElement(\"h1\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 264,\n    columnNumber: 17\n  }\n}, \"Complete your order\"), /*#__PURE__*/React.createElement(Elements, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 265,\n    columnNumber: 17\n  }\n}, /*#__PURE__*/React.createElement(InjectedForm, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 266,\n    columnNumber: 21\n  }\n})))));\n\nexport default WrappedForm;","map":{"version":3,"sources":["/home/gnop/Videos/django-react-boilerplate/src/containers/Checkout.js"],"names":["React","Component","CardElement","injectStripe","Elements","StripeProvider","Button","Container","Dimmer","Divider","Form","Item","Header","Message","Loader","Label","Segment","authAxios","checkoutURL","orderSummaryURL","addCouponURL","OrderPreview","state","data","error","loading","handleFetchOrder","setState","get","then","res","catch","err","reponse","status","componentDidMount","render","JSON","stringify","order_items","map","order_item","i","console","log","item_obj","image","quantity","title","final_price","total","CouponForm","handleAddCoupon","e","preventDefault","code","post","handleChange","target","value","CheckoutForm","success","submit","ev","props","stripe","createToken","result","message","stripeToken","token","id","marginTop","InjectedForm","WrappedForm"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n    CardElement,\n    injectStripe,\n    Elements,\n    StripeProvider\n} from 'react-stripe-elements';\nimport {\n    Button,\n    Container,\n    Dimmer,\n    Divider,\n    Form,\n    Item,\n    Header,\n    Message,\n    Loader,\n    Label,\n    Segment\n\n} from 'semantic-ui-react';\nimport { authAxios } from '../utils';\nimport { checkoutURL, orderSummaryURL, addCouponURL } from '../constants';\n\n\n\nclass OrderPreview extends Component {\n\n    state = {\n        data: null,\n        error: null,\n        loading: false\n    }\n\n    componentDidMount() {\n        this.handleFetchOrder();\n    }\n\n    handleFetchOrder = () => {\n        this.setState({ loading: true });\n        authAxios\n            .get(orderSummaryURL)\n            .then(res => {\n                //console.log(res.data);\n                this.setState({ data: res.data, loading: false });\n            })\n            .catch(err => {\n                if (err.reponse.status === 404) {\n                    this.setState({ error: \"You currently do not have an order\", loading: false });\n                } else {\n                    this.setState({ error: err, loading: false });\n                }\n            });\n    };\n\n    render() {\n        const { data, error, loading } = this.state;\n\n        return (\n            <React.Fragment>\n                {error && (\n                    <Message\n                        error\n                        header=\"There was an error\"\n                        content={JSON.stringify(error)}\n                    />\n                )}\n                {loading && (\n                    <Segment>\n                        <Dimmer>\n                            <Loader inverted>Loading</Loader>\n                        </Dimmer>\n                    </Segment>\n                )}\n                {data && (\n                    <React.Fragment>\n                        <Item.Group relaxed>\n                            {data.order_items.map((order_item, i) => {\n                                console.log(order_item);\n                                return (\n                                    <Item key={i}>\n                                        <Item.Image\n                                            size=\"tiny\"\n                                            src={`http://127.0.0.1:8000${order_item.item_obj.image}`}\n                                        />\n\n                                        <Item.Content verticalAlign=\"middle\">\n                                            <Item.Header as=\"a\">\n                                                {order_item.quantity} x {order_item.item_obj.title}\n                                            </Item.Header>\n                                            <Item.Extra>\n                                                <Label>${order_item.final_price}</Label>\n                                            </Item.Extra>\n                                        </Item.Content>\n\n\n                                    </Item>\n                                );\n                            })}\n\n                        </Item.Group>\n\n                        <Item.Group>\n                            <Item.Content>\n                                <Item.Header>Order Total: ${data.total} </Item.Header>\n                            </Item.Content>\n                        </Item.Group>\n                    </React.Fragment>\n                )}\n\n            </React.Fragment>\n        );\n    }\n}\n\n\nclass CouponForm extends Component {\n\n    state = {\n        error: null,\n        loading: false\n    }\n\n    handleAddCoupon = e => {\n        e.preventDefault();\n        const { code } = this.state;\n        this.setState({ loading: true });\n        authAxios\n            .post(addCouponURL, { code })\n            .then(res => {\n                this.setState({ loading: false });\n            })\n            .catch(err => {\n\n                this.setState({ error: err, loading: false });\n\n            });\n    }\n\n    handleChange = e => {\n        this.setState({\n            code: e.target.value\n        })\n    }\n\n    render() {\n        const { code, error, loading } = this.state;\n\n        return (\n            <React.Fragment>\n                {error && (\n                    <Message\n                        error\n                        header=\"There was an error\"\n                        content={JSON.stringify(error)}\n                    />\n                )}\n                {loading && (\n                    <Segment>\n                        <Dimmer>\n                            <Loader inverted>Loading</Loader>\n                        </Dimmer>\n                    </Segment>\n                )}\n\n                <Form onSubmit={this.handleAddCoupon}>\n                    <Form.Field>\n                        <label>Coupon code</label>\n                        <input placeholder=\"Enter a coupon...\" value={code} onChange={this.handleChange} />\n                    </Form.Field>\n                </Form>\n\n            </React.Fragment>\n        )\n    }\n}\n\n\n\nclass CheckoutForm extends Component {\n\n    state = {\n        loading: false,\n        error: null,\n        success: false\n    }\n\n    submit = (ev) => {\n        ev.preventDefault();\n        this.setState({ loading: true });\n        if (this.props.stripe) {\n            this.props.stripe.createToken()\n                .then(result => {\n                    if (result.error) {\n                        this.setState({ error: result.error.message, loading: false });\n                    } else {\n                        authAxios\n                            .post(checkoutURL, { stripeToken: result.token.id })\n                            .then(res => {\n                                this.setState({ loading: true, success: true });\n                            })\n                            .catch(err => {\n                                this.setState({ loading: false, error: err });\n                            });\n                    }\n                });\n        } else {\n            console.log(\"Stripe is not loaded\");\n        }\n\n    };\n\n    render() {\n        const { error, loading, success } = this.state;\n        return (\n            <div>\n                {error && (\n                    <Message negative>\n                        <Message.Header>Your payment was unsuccessful</Message.Header>\n                        <p>{JSON.stringify(error)}</p>\n                    </Message>\n                )}\n                {success && (\n                    <Message positive>\n                        <Message.Header>Your payment was successful</Message.Header>\n                        <p>\n                            Go to your <b>profile</b> to see the order delivery status.\n                        </p>\n                    </Message>\n                )}\n\n\n                <OrderPreview />\n\n\n                <Divider />\n                <CouponForm />\n                <Divider />\n\n                <Header>Would you like to complete your puchase?</Header>\n                <CardElement />\n                <Button\n                    onClick={this.submit}\n                    primary\n                    style={{ marginTop: \"10px\" }}\n                    loading={loading}\n                    disabled={loading}\n                >\n                    Submit\n                </Button>\n            </div>\n        );\n    }\n}\n\n\nconst InjectedForm = injectStripe(CheckoutForm);\n\n\nconst WrappedForm = () => (\n    <Container text>\n        <StripeProvider apiKey=\"pk_test_ffJsfC2lo7brg48q4ijmDjK000UJ9rB62K\">\n            <div>\n                <h1>Complete your order</h1>\n                <Elements>\n                    <InjectedForm />\n                </Elements>\n\n            </div>\n\n        </StripeProvider>\n    </Container>\n\n);\n\nexport default WrappedForm;"]},"metadata":{},"sourceType":"module"}